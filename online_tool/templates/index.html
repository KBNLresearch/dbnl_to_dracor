{% extends 'base.html' %}

{% block header %}
  <h1>!!</h1>
{% endblock %}

{% block content %}
 <form method="post">

    <label for="url">Link to DBNL input XML</label>
    <input type="text" name="url" value='https://www.dbnl.org/nieuws/xml.php?id=vond001gysb01'></input><br>

    <input type="checkbox" id="pb" name="pb" value="pb">
    <label for="pb"> "pb" elementen inclusief attributen pb.*?</label><br>

    <input type="checkbox" id="hi" name="hi" value="hi">
    <label for="hi"> "hi" elementen inclusief attributen, exclusief inhoud hi.*? + hi.*?\n.*? + hi</label><br>

    <input type="checkbox" id="rend" name="rend" value="rend">
    <label for="rend"> "rend" attributen inclusief waardes (' rend=".*?"')'''</label><br>

    <input type="checkbox" id="xptr" name="xptr" value="xptr">
    <label for="xptr"> elementen inclusief attributen xptr.*?</label><br>

    <input type="submit" value="Process XML">
  </form>


    <form id="xmlForm">
        <textarea id="xmlEditor"></textarea>
    </form>
    <script>
        // Load the initial XML content from the Flask server
        const initialXML = `{{ xml_data | safe }}`;

        // Initialize CodeMirror on the textarea
        const editor = CodeMirror.fromTextArea(document.getElementById('xmlEditor'), {
            lineNumbers: true,
            mode: 'xml',
            theme: 'default'
        });

        // Set the editor's content to the XML fetched from the server
        editor.setValue(initialXML);

        // Handle form submission
        document.getElementById('xmlForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const xmlContent = editor.getValue();

            // Send the XML content to the Flask backend
            fetch('/process_xml', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ xml: xmlContent })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('output').innerText = data.output;
            })
            .catch(error => console.error('Error:', error));
        });
    </script>

 

{% endblock %}

